<h1>Listado de Productos</h1>

<a class="button button--primary" href="/productos/create">Crear un producto</a>

<section class="listados">
<table>
    <thead>
        <tr>
            <th>Nombre</th>
        </tr>
    </thead>
    <tbody>
        <% productos.forEach(prod => { %> 
            <tr>
                <td><a href="/productos/<%= prod.id %>"><%= prod.name %></a></td>
                <td class="cell-inline">
                    <a class="button button--primary" href="/productos/<%= prod.id %>/edit">Edit</a>
                    <!-- Se va a simular el método DELETE a través del método post -->
                    <form class="form-delete" action="/productos/<%= prod.id %>?_method=DELETE" method="post">
                        <button class="button button--danger" type="submit">Borrar</button>
                    </form>
                </td>
            </tr>
        <% }) %>
    </tbody>
</table>
</section>

<script> 
    /** Este script se pone a escuchar cualquier evento SUBMIT.
    * Evita que se envie por default.
    * Y si la lista de clases a la que pertenece contiene 'form-delete'
    * entonces pide confirmación del borrado. */
    document.addEventListener("submit", (event) => {
        event.preventDefault(); 

        if (event.target.classList.contains("form-delete")) {
            if (confirm("¿Está seguro?")) {
                event.target.submit(); 
            }
        }
    })
</script>